<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.66">
<link rel="stylesheet" href="fonts/fonts.css"><title data-react-helmet="true">#[ink::contract] | pro! documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="#[ink::contract] | pro! documentation"><meta data-react-helmet="true" name="description" content="This macro is the entry point for writing pro! smart contracts."><meta data-react-helmet="true" property="og:description" content="This macro is the entry point for writing pro! smart contracts."><meta data-react-helmet="true" property="og:url" content="https://github.com/paritytech/ink/pro-docs/macros-attributes/contract"><link data-react-helmet="true" rel="shortcut icon" href="/pro-docs/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://github.com/paritytech/ink/pro-docs/macros-attributes/contract"><link rel="stylesheet" href="/pro-docs/styles.72dc51c1.css">
<link rel="preload" href="/pro-docs/styles.bffd6a16.js" as="script">
<link rel="preload" href="/pro-docs/runtime~main.b5c8fe83.js" as="script">
<link rel="preload" href="/pro-docs/main.5b6660b8.js" as="script">
<link rel="preload" href="/pro-docs/1.d5f44af2.js" as="script">
<link rel="preload" href="/pro-docs/2.e392b2d8.js" as="script">
<link rel="preload" href="/pro-docs/57.3a5cf41c.js" as="script">
<link rel="preload" href="/pro-docs/935f2afb.d7e0b259.js" as="script">
<link rel="preload" href="/pro-docs/17896441.65c2475b.js" as="script">
<link rel="preload" href="/pro-docs/7bb98f5d.25a93d0a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/pro-docs/"><img class="navbar__logo" src="/pro-docs/img/logo-black.svg" alt="pro!"><strong class="navbar__title"></strong></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/paritytech/ink" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">pro! GitHub</a><a href="https://github.com/paritytech/pro-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Docs GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/pro-docs/"><img class="navbar__logo" src="/pro-docs/img/logo-black.svg" alt="pro!"><strong class="navbar__title"></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/paritytech/ink" target="_blank" rel="noopener noreferrer" class="menu__link">pro! GitHub</a></li><li class="menu__list-item"><a href="https://github.com/paritytech/pro-docs" target="_blank" rel="noopener noreferrer" class="menu__link">Docs GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Overview</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/why-rust-for-smart-contracts">Why Rust for Smart Contracts?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/why-webassembly-for-smart-contracts">Why WebAssembly for Smart Contracts?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/how-it-works">How it Works â€’ Substrate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/ink-vs-solidity">pro! vs. Solidity</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/getting-started/setup">Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/getting-started/creating-an-ink-project">Creating an pro! Project</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/getting-started/building-your-contract">Compile Your Contract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/getting-started/running-substrate">Run a Substrate Node</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/getting-started/deploy-your-contract">Deploy Your Contract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/getting-started/calling-your-contract">Call Your Contract</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/getting-started/troubleshooting">Troubleshooting</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Basics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/basics/contract-template">Contract Template</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/basics/storing-values">Storing Values</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/basics/reading-values">Reading Values from Storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/basics/mutating-values">Mutating Storage Values</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/basics/events">Events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/basics/trait-definitions">Trait Definitions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/basics/cross-contract-calling">Cross-Contract Calling</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/basics/contract-testing">Contract Testing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/basics/environment-functions">Environment Functions</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Macros &amp; Attributes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pro-docs/macros-attributes">Overview</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/pro-docs/macros-attributes/contract">#[ink::contract]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pro-docs/macros-attributes/anonymous">#[ink(anonymous)]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pro-docs/macros-attributes/constructor">#[ink(constructor)]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pro-docs/macros-attributes/event">#[ink(event)]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pro-docs/macros-attributes/impl">#[ink(impl)]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pro-docs/macros-attributes/message">#[ink(message)]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pro-docs/macros-attributes/namespace">#[ink(namespace = &quot;â€¦&quot;)]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pro-docs/macros-attributes/payable">#[ink(payable)]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pro-docs/macros-attributes/selector">#[ink(selector = &quot;â€¦&quot;)]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pro-docs/macros-attributes/storage">#[ink(storage)]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pro-docs/macros-attributes/topic">#[ink(topic)]</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/pro-docs/macros-attributes/chain-extension">#[ink::chain_extension]</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Storage &amp; Data Structures</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/datastructures/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/datastructures/hashmap">Working with Datastructures</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/datastructures/spread-packed-layout">Spread vs. Packed</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/datastructures/opting-out">Opt out of Storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/datastructures/dynamic-allocation">Dynamic Storage Allocator</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/datastructures/custom-datastructure">Custom Datastructures</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Examples</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/examples">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">cargo-contract CLI</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/cargo-contract-cli">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Canvas Test Network</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/canvas">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">FAQ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/pro-docs/faq">Frequently Asked Questions</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">#[ink::contract]</h1></header><div class="markdown"><p>This macro is the entry point for writing pro! smart contracts.</p><p>If you are a beginner trying to learn pro! we recommend you to check out
our extensive <a href="https://substrate.dev/substrate-contracts-workshop/#/" target="_blank" rel="noopener noreferrer">pro! workshop</a>.</p><p><strong>Note:</strong> In all below examples we will be using <code>ink_lang</code> crate aliased as just <code>ink</code>.
You can do this yourself by adding the following line to your code:
<code>use ink_lang as ink;</code></p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="description"></a>Description<a aria-hidden="true" tabindex="-1" class="hash-link" href="#description" title="Direct link to heading">#</a></h1><p>The macro does analysis on the provided smart contract code and generates
proper code.</p><p>pro! smart contracts can compile in several different modes.
There are two main compilation modes using either</p><ul><li>on-chain mode: <code>no_std</code> + WebAssembly as target</li><li>off-chain mode: <code>std</code></li></ul><p>We generally use the on-chain mode for actual smart contract deployment
whereas we use the off-chain mode for smart contract testing using the
off-chain environment provided by the <code>ink_env</code> crate.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="usage"></a>Usage<a aria-hidden="true" tabindex="-1" class="hash-link" href="#usage" title="Direct link to heading">#</a></h1><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="header-arguments"></a>Header Arguments<a aria-hidden="true" tabindex="-1" class="hash-link" href="#header-arguments" title="Direct link to heading">#</a></h2><p>The <code>#[ink::contract]</code> macro can be provided with some additional comma-separated
header arguments:</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="dynamic_storage_allocator-bool"></a><code>dynamic_storage_allocator: bool</code><a aria-hidden="true" tabindex="-1" class="hash-link" href="#dynamic_storage_allocator-bool" title="Direct link to heading">#</a></h3><p>Tells the pro! code generator to allow usage of pro!&#x27;s built-in dynamic
storage allocator.</p><ul><li><code>true</code>: Use the dynamic storage allocator provided by pro!.</li><li><code>false</code>: Do NOT use the dynamic storage allocator provided by pro!.</li></ul><p>This feature is generally only needed for smart contracts that try to model
their data in a way that contains storage entites within other storage
entities.</p><p>Contract writers should try to write smart contracts that do not depend on the
dynamic storage allocator since enabling it comes at a cost of increased Wasm
file size. Although it will enable interesting use cases. Use it with care!</p><p>An example for this is the following type that could potentially be used
within a contract&#x27;s storage struct definition:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-rust codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token plain">// A storage vector of storage vectors.</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">use ink_storage as storage;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">type VectorOfVectors = storage::Vec&lt;storage::Vec&lt;i32&gt;&gt;;</span></div></div></div></div></div><p><strong>Usage Example:</strong></p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-rust codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token plain">use ink_lang as ink;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">#[ink::contract(dynamic_storage_allocator = true)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">mod my_contract {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(storage)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct MyStorage;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    impl MyStorage {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(constructor)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn construct() -&gt; Self { MyStorage {} }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn message(&amp;self) {}</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    // ...</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">}</span></div></div></div></div></div><p><strong>Default value:</strong> <code>false</code></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="compile_as_dependency-bool"></a><code>compile_as_dependency: bool</code><a aria-hidden="true" tabindex="-1" class="hash-link" href="#compile_as_dependency-bool" title="Direct link to heading">#</a></h3><p>Tells the pro! code generator to <strong>always</strong> or <strong>never</strong>
compile the smart contract as if it was used as a dependency of another pro!
smart contract.</p><p>Normally this flag is only really useful for pro! developers who
want to inspect code generation of pro! smart contracts.
The author is not aware of any particular practical use case for users that
makes use of this flag but contract writers are encouraged to disprove this.</p><p>Note that it is recommended to make use of the built-in crate feature
<code>ink-as-dependency</code> to flag smart contract dependencies listed in a contract&#x27;s
<code>Cargo.toml</code> as actual dependencies to pro!.</p><p><strong>Usage Example:</strong></p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-rust codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token plain">use ink_lang as ink;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">#[ink::contract(compile_as_dependency = true)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">mod my_contract {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(storage)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct MyStorage;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    impl MyStorage {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(constructor)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn construct() -&gt; Self { MyStorage {} }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn message(&amp;self) {}</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    // ...</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">}</span></div></div></div></div></div><p><strong>Default value:</strong> Depends on the crate feature propagation of <code>Cargo.toml</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="env-impl-environment"></a><code>env: impl Environment</code><a aria-hidden="true" tabindex="-1" class="hash-link" href="#env-impl-environment" title="Direct link to heading">#</a></h3><p>Tells the pro! code generator which environment to use for the pro! smart contract.
The environment must implement the <code>Environment</code> (defined in <code>ink_env</code>) trait and provides
all the necessary fundamental type definitions for <code>Balance</code>, <code>AccountId</code> etc.</p><p>When using a custom <code>Environment</code> implementation for a smart contract all types
that it exposes to the pro! smart contract and the mirrored types used in the runtime
must be aligned with respect to SCALE encoding and semantics.</p><p><strong>Usage Example:</strong></p><p>Given a custom <code>Environment</code> implementation:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-rust codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token plain">pub struct MyEnvironment;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">impl ink_env::Environment for MyEnvironment {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    const MAX_EVENT_TOPICS: usize = 3;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    type AccountId = u64;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    type Balance = u128;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    type Hash = [u8; 32];</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    type Timestamp = u64;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    type BlockNumber = u32;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    type ChainExtension = ::ink_env::NoChainExtension;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">}</span></div></div></div></div></div><p>A user might implement their pro! smart contract using the above custom <code>Environment</code>
implementation as demonstrated below:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-rust codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token plain">use ink_lang as ink;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">#[ink::contract(env = MyEnvironment)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">mod my_contract {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct MyEnvironment;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">   </span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    impl ink_env::Environment for MyEnvironment {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        const MAX_EVENT_TOPICS: usize = 3;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        type AccountId = u64;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        type Balance = u128;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        type Hash = [u8; 32];</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        type Timestamp = u64;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        type BlockNumber = u32;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        type ChainExtension = ::ink_env::NoChainExtension;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(storage)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct MyStorage;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    </span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    impl MyStorage {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(constructor)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn construct() -&gt; Self { MyStorage {} }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        </span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn message(&amp;self) {}</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    // ...</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">}</span></div></div></div></div></div><p><strong>Default value:</strong> <code>DefaultEnvironment</code> defined in <code>ink_env</code> crate.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="anaylsis"></a>Anaylsis<a aria-hidden="true" tabindex="-1" class="hash-link" href="#anaylsis" title="Direct link to heading">#</a></h2><p>The <code>#[ink::contract]</code> macro fully analyses its input smart contract
against invalid arguments and structure.</p><p>Some example rules include but are not limited to:</p><ul><li><p>There must be exactly one <code>#[ink(storage)]</code> struct.</p><p>   This struct defines the layout of the storage that the pro! smart contract operates on.
The user is able to use a variety of built-in facilities, combine them in various ways
or even provide their own implementations of storage data structures.</p><p>   For more information visit the <code>ink_storage</code> crate documentation.</p><p>   <strong>Example:</strong></p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-rust codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token plain">use ink_lang as ink;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">#[ink::contract]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">mod flipper {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(storage)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct Flipper {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        value: bool,</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    impl Flipper {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(constructor)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn construct() -&gt; Self { Flipper { value: false } }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn message(&amp;self) {}</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">}</span></div></div></div></div></div></li><li><p>There must be at least one <code>#[ink(constructor)]</code> defined method.</p><p>   Methods flagged with <code>#[ink(constructor)]</code> are special in that they are dispatchable
upon contract instantiation. A contract may define multiple such constructors which
allow users of the contract to instantiate a contract in multiple different ways.</p><p>   <strong>Example:</strong></p><p>   Given the <code>Flipper</code> contract definition above we add an <code>#[ink(constructor)]</code>
as follows:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-rust codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token plain">use ink_lang as ink;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">#[ink::contract]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">mod flipper {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(storage)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct Flipper {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        value: bool,</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    impl Flipper {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(constructor)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn new(initial_value: bool) -&gt; Self {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            Flipper { value: false }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn message(&amp;self) {}</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">}</span></div></div></div></div></div></li><li><p>There must be at least one <code>#[ink(message)]</code> defined method.</p><p>   Methods flagged with <code>#[ink(message)]</code> are special in that they are dispatchable
upon contract invocation. The set of pro! messages defined for an pro! smart contract
define its API surface with which users are allowed to interact.</p><p>   An pro! smart contract can have multiple such pro! messages defined.</p><p>   <strong>Note:</strong></p><ul><li><p>An pro! message with a <code>&amp;self</code> receiver may only read state whereas an pro! message
with a <code>&amp;mut self</code> receiver may mutate the contract&#x27;s storage.</p><p><strong>Example:</strong></p><p>Given the <code>Flipper</code> contract definition above we add some <code>#[ink(message)]</code> definitions
as follows:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-rust codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token plain">use ink_lang as ink;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">#[ink::contract]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">mod flipper {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(storage)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct Flipper {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        value: bool,</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    impl Flipper {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(constructor)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn new(initial_value: bool) -&gt; Self {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            Flipper { value: false }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        /// Flips the current value.</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn flip(&amp;mut self) {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            self.value = !self.value;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        /// Returns the current value.</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn get(&amp;self) -&gt; bool {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            self.value</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">}</span></div></div></div></div></div><p><strong>Payable Messages:</strong></p><p>An pro! message by default will reject calls that additional fund the smart contract.
Authors of pro! smart contracts can make an pro! message payable by adding the <code>payable</code>
flag to it. An example below:</p><p>Note that pro! constructors are always implicitly payable and thus cannot be flagged
as such.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-rust codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token plain">use ink_lang as ink;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">#[ink::contract]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">mod flipper {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(storage)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct Flipper {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        value: bool,</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    impl Flipper {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(constructor)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn new(initial_value: bool) -&gt; Self {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            Flipper { value: false }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        /// Flips the current value.</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(payable)] // You can either specify payable out-of-line.</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn flip(&amp;mut self) {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            self.value = !self.value;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        /// Returns the current value.</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message, payable)] // ... or specify payable inline.</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn get(&amp;self) -&gt; bool {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            self.value</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">}</span></div></div></div></div></div><p><strong>Controlling the messages selector:</strong></p><p>Every pro! message and pro! constructor has a unique selector with which the
message or constructor can be uniquely identified within the pro! smart contract.
These selectors are mainly used to drive the contract&#x27;s dispatch upon calling it.</p><p>An pro! smart contract author can control the selector of an pro! message or pro!
constructor using the <code>selector</code> flag. An example is shown below:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-rust codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token plain">use ink_lang as ink;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">#[ink::contract]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">mod flipper {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(storage)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct Flipper {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        value: bool,</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    impl Flipper {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(constructor)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(selector = &quot;0xDEADBEEF&quot;)] // Works on constructors as well.</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn new(initial_value: bool) -&gt; Self {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            Flipper { value: false }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        /// Flips the current value.</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(selector = &quot;0xCAFEBABE&quot;)] // You can either specify selector out-of-line.</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn flip(&amp;mut self) {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            self.value = !self.value;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">       </span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        /// Returns the current value.</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message, selector = &quot;0xFEEDBEEF&quot;)] // ... or specify selector inline.</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn get(&amp;self) -&gt; bool {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            self.value</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">}</span></div></div></div></div></div></li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="interacting-with-the-contract-executor"></a>Interacting with the Contract Executor<a aria-hidden="true" tabindex="-1" class="hash-link" href="#interacting-with-the-contract-executor" title="Direct link to heading">#</a></h2><p>The <code>ink_env</code> crate provides facitilies to interact with the contract executor that
connects pro! smart contracts with the outer world.</p><p>For example it is possible to query the current call&#x27;s caller via:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-rust codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token plain">use ink_env;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">ink_env::test::run_test::&lt;ink_env::DefaultEnvironment, _&gt;(|_| {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    let caller = ink_env::caller::&lt;ink_env::DefaultEnvironment&gt;();</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    let _caller = caller;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    Ok(())</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">}).unwrap();</span></div></div></div></div></div><p>However, pro! provides a much simpler way to interact with the contract executor
via its environment accessor. An example below:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-rust codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token plain">use ink_lang as ink;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain"> </span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">#[ink::contract]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">mod greeter {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(storage)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct Greeter;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    impl Greeter {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(constructor)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn new() -&gt; Self {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            let caller = Self::env().caller();</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            let message = format!(&quot;thanks for instantiation {:?}&quot;, caller);</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            ink_env::debug_println(&amp;message);</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            Greeter {}</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message, payable)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn fund(&amp;mut self) {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            let caller = self.env().caller();</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            let value = self.env().transferred_balance();</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            let message = format!(&quot;thanks for the funding of {:?} from {:?}&quot;, value, caller);</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            ink_env::debug_println(&amp;message);</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">}</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="events"></a>Events<a aria-hidden="true" tabindex="-1" class="hash-link" href="#events" title="Direct link to heading">#</a></h2><p>An pro! smart contract may define events that it can emit during contract execution.
Emitting events can be used by third party tools to query information about a contract&#x27;s
execution and state.</p><p>The following example pro! contract shows how an event <code>Transferred</code> is defined and
emitted in the <code>#[ink(constructor)]</code>.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-rust codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token plain"> use ink_lang as ink;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain"> </span></div><div class="token-line" style="color:#9a86fd"><span class="token plain"> #[ink::contract]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain"> mod erc20 {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">     /// Defines an event that is emitted every time value is transferred.</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">     #[ink(event)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">     pub struct Transferred {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">         from: Option&lt;AccountId&gt;,</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">         to: Option&lt;AccountId&gt;,</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">         value: Balance,</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">     }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">     #[ink(storage)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">     pub struct Erc20 {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">         total_supply: Balance,</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">         // more fields ...</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">     }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">     impl Erc20 {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">         #[ink(constructor)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">         pub fn new(initial_supply: Balance) -&gt; Self {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">             let caller = Self::env().caller();</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">             Self::env().emit_event(Transferred {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">                 from: None,</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">                 to: Some(caller),</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">                 value: initial_supply,</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">             });</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">             Self { total_supply: initial_supply }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">         }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">         #[ink(message)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">         pub fn total_supply(&amp;self) -&gt; Balance {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">             self.total_supply</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">         }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">     }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain"> }</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="example-flipper"></a>Example: Flipper<a aria-hidden="true" tabindex="-1" class="hash-link" href="#example-flipper" title="Direct link to heading">#</a></h2><p>The below code shows the complete implementation of the so-called Flipper
pro! smart contract.
For us it acts as the &quot;Hello, World!&quot; of the pro! smart contracts because
it is minimal while still providing some more or less useful functionality.</p><p>It controls a single <code>bool</code> value that can be either <code>false</code> or <code>true</code>
and allows the user to flip this value using the <code>Flipper::flip</code> message
or retrieve the current value using <code>Flipper::get</code>.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-rust codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="background-color:#2a2734;color:#9a86fd"><div class="token-line" style="color:#9a86fd"><span class="token plain">use ink_lang as ink;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">#[ink::contract]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">pub mod flipper {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    #[ink(storage)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    pub struct Flipper {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        value: bool,</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    impl Flipper {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        /// Creates a new flipper smart contract initialized with the given value.</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(constructor)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn new(init_value: bool) -&gt; Self {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            Self { value: init_value }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        /// Flips the current value of the Flipper&#x27;s bool.</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn flip(&amp;mut self) {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            self.value = !self.value;</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        /// Returns the current value of the Flipper&#x27;s bool.</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        #[ink(message)]</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        pub fn get(&amp;self) -&gt; bool {</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">            self.value</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">        }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">    }</span></div><div class="token-line" style="color:#9a86fd"><span class="token plain">}</span></div></div></div></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/pro-docs/edit/master/docs/macros-attributes/contract.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/pro-docs/macros-attributes"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Overview</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/pro-docs/macros-attributes/anonymous"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">#[ink(anonymous)] Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#header-arguments" class="table-of-contents__link">Header Arguments</a><ul><li><a href="#dynamic_storage_allocator-bool" class="table-of-contents__link"><code>dynamic_storage_allocator: bool</code></a></li><li><a href="#compile_as_dependency-bool" class="table-of-contents__link"><code>compile_as_dependency: bool</code></a></li><li><a href="#env-impl-environment" class="table-of-contents__link"><code>env: impl Environment</code></a></li></ul></li><li><a href="#anaylsis" class="table-of-contents__link">Anaylsis</a></li><li><a href="#interacting-with-the-contract-executor" class="table-of-contents__link">Interacting with the Contract Executor</a></li><li><a href="#events" class="table-of-contents__link">Events</a></li><li><a href="#example-flipper" class="table-of-contents__link">Example: Flipper</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/pro-docs/styles.bffd6a16.js"></script>
<script src="/pro-docs/runtime~main.b5c8fe83.js"></script>
<script src="/pro-docs/main.5b6660b8.js"></script>
<script src="/pro-docs/1.d5f44af2.js"></script>
<script src="/pro-docs/2.e392b2d8.js"></script>
<script src="/pro-docs/57.3a5cf41c.js"></script>
<script src="/pro-docs/935f2afb.d7e0b259.js"></script>
<script src="/pro-docs/17896441.65c2475b.js"></script>
<script src="/pro-docs/7bb98f5d.25a93d0a.js"></script>
</body>
</html>